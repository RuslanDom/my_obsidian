Dockerfile — это текстовый файл специального формата, содержащий команды для сборки Docker-образа. Эти команды описывают шаги, необходимые для установки зависимостей и конфигурации вашего приложения с учетом контекста приложения.
## Простой пример Dockerfile
Пример:
1. Создаём Dockerfile
```dockerfile
# Вызывается из директории с приложением  
# docker build -t test_app .  
  
FROM python:3.12.3  
  
RUN mkdir /app  
# Копируем файл с зависимостями 1-й аргумент файлова система host 2-й аргумент файловая система образа  
COPY requirements.txt /app/  
# Копируем файл с приложением  
COPY app.py /app/  
  
RUN python -m pip install -r /app/requirements.txt
```

2. Записываем нужные frames и зависимости в requirements.txt
```txt
flask==3.1.0
```

3. Запускаем docker build
```console
sudo docker build -t test_app .
```

1. Запуск приложения, порты 5050 внешний и 5000 порт docker
```console
docker run -p 5050:5000 test_app python /app/app.py
```


```

Рассмотрим простой пример Dockerfile для приложения на Node.js:

```dockerfile
# Указываем базовый образ
FROM node:14
# Устанавливаем рабочую директорию внутри будущего контейнера
WORKDIR /app
# Копируем package.json и package-lock.json в /app (./ из-за WORKDIR)
COPY package*.json ./
# Устанавливаем зависимости
RUN npm install
# Копируем файлы приложения (с хоста (контекст) в образ (/app))
COPY . .
# Открываем порт
EXPOSE 3000
# Запускаем приложение
CMD ["node", "server.js"]
```


## Docker build
Теперь можно попробовать собрать приложение: 
```shell
docker build -t node-app:latest
```

-t указывает docker собрать образ с тегом  
node-app — название образа  
latest — тег

После того, как Docker завершит сборку успехом, можно запустить приложение: 
```shell
docker run node-app
```

## Поэтапная (multistage) сборка
multistage -сборка позволяет уменьшить размер итоговых образов, используя несколько команд FROM. В качестве примера рассмотрим сборку простого Go-приложения:
```dockerfile

# BUILD STAGE
FROM golang:1.16 AS build
WORKDIR /go/src/app
COPY . .
RUN go build -o myapp
# RUN STAGE
FROM alpine:latest
WORKDIR /root/
COPY --from=build /go/src/app/myapp .
CMD ["./myapp"]
```

